# Project_weather_forecast

**Проект №35**

**Тема:** 
Предсказание погоды для города/городов

**Куратор:** Васильев Николай @nnvasilevkk

**Участники (Команда 54):**  
- Гаврилова Анастасия Витальевна @kadaobed  
- Ковырков Денис Андреевич @denis_kovyrkov  
- Лысов Игорь Игоревич @lysov1  
- Панченко Василий Игоревич @panchenko_vi  
- Чуканов Тимофей Вячеславович @Timm27


## Описание проектa ##
  
### Цель проекта
Разработка и реализация сервиса для предсказания погоды в нескольких городах при помощи ML и TS на основе исторических данных о погоде, полученных через API.

### Результаты
- Сервис, предоставляющий предсказания погоды на основе классических моделей машинного обучения и моделей временных рядов для города или нескольких городов.
-	Документация, описывающая все этапы проекта, включая методы получения данных через API, предобработку, анализ, обучение классических моделей и моделей временных рядов, а также их оптимизацию.
-В зависимости от исходных данных можно предсказывать следующие погодные условия:
    *	Температура воздуха (максимальная, минимальная, средняя)
    *	Осадки (дождь, снег, количество осадков в мм)
    *	Влажность воздуха
    *	Атмосферное давление
    *	Скорость и направление ветра


### Дополнительные возможности
-	Интеграция с другими API для получения данных о климатических условиях или дополнительных метеорологических параметрах.
-	Визуализация данных и предсказаний на интерактивных графиках в микросервисе.

## Пользовательская инструкция для Streamlit-приложения

Приложение имеет 3 страницы:
1) Стартовая страница (вкладка Start)
2) Страница с EDA-частью (вкладка EDA)
3) Страница с ML-частью (вкладка ML)
   
Для переключения между страницами пользователь должен кликнуть на соответствующую вкладку
слева.

### Описание вкладок 

1) Вкладка Start
   - Краткая навигация по приложению.
<img width="1460" alt="Снимок экрана 2025-01-01 в 19 04 46" src="https://github.com/user-attachments/assets/376434d7-7e1b-4071-989f-16d3d92db054" />

2) Вкладка EDA
   - Содержит графики временных рядов для следующих погодных данных: температура,
влажность, давление, скорость ветра и их прогноз на следующие сутки и некоторую описательную статистику.

См. gif по ссылке: https://drive.google.com/drive/folders/1jOdLWER0UzI61nNaeFkjCuH9q4vadBzR

3) Вкладка ML
   - Раздел «Загрузка данных»
     * Пользователь загружает последние данные о погоде в формате csv-файла в окно для загрузки и нажимает кнопку «Сохранить загруженные данные».
     * См. gif по ссылке: https://drive.google.com/drive/folders/1jOdLWER0UzI61nNaeFkjCuH9q4vadBzR
   - Раздел «Создание нового класса модели»
     * Пользователь вручную вводит id и гиперпараметры новой модели, которую он далее хочет
обучить, и нажимает кнопку «Создать новый класс для модели».
     * См. gif по ссылке: https://drive.google.com/drive/folders/1jOdLWER0UzI61nNaeFkjCuH9q4vadBzR
   - Раздел «Обучение модели»
     * В разделе описаны параметры и кривая обучения предобученной LSTM-модели.
     * <img width="1882" alt="Предобученная модель" src="https://github.com/user-attachments/assets/5948524d-efd7-4892-94c9-d5db6849433c" />

   - Раздел «Загруженные модели»
     * При нажатии на кнопку «Показать все загруженные модели» приложение выводит список
всех загруженных и обученных ML-моделей.
   - Раздел «Установка активной модели»
     * Пользователь вручную вводит id модели, которая далее будет обучаться и по которой будет
строиться прогноз, и нажимает кнопку «Установить активную модель».
     * См. gif по ссылке: https://drive.google.com/drive/folders/1jOdLWER0UzI61nNaeFkjCuH9q4vadBzR
   - Раздел «Обучение активной модели»
     * Пользователь нажимает кнопку «Обучить активную модель».
   - Раздел «Прогноз активной модели»
     * Пользователь вводит дату и время, на которое строится прогноз, и горизонт
прогнозирования и нажимает кнопку «Показать прогноз температуры».
     * См. gif по ссылке: https://drive.google.com/drive/folders/1jOdLWER0UzI61nNaeFkjCuH9q4vadBzR

# Сборка и запуск

Для frontend и backend собираются по 1 докер образу. Собрать можно автоматически или вручную.

## Автоматическая сборка docker образов

Автоматическая сборка происходит с помощью github-actions при каждом пуше коммита или тега в репозиторий. Собранные образы автоматически пушатся в dockerhub. Также обновляются 2 образа:
* tfonferm/ai35_weather_forecast:backend-latest
* tfonferm/ai35_weather_forecast:frontend-latest

## Сборка docker образов вручную

Для сборки backend-образа, выполните `docker build -t tfonferm/ai35_weather_forecast:backend-latest -f service/backend/Dockerfile .`.

Для сборки frontend-образа, выполните `docker build -t tfonferm/ai35_weather_forecast:frontend-latest -f service/frontend/Dockerfile .`.

## Запуск сервисов вручную с помощью docker compose

Перед ручным запуском в файле `service/docker-compose/.env` заполните пароль от базы и API-ключ сервиса с данными о погоде.

После этого, для ручного запуска выполните следующие команды:
```sh
cd service/docker-compose/
docker compose pull
docker compose up -d
```

Порты указываются в `docker-compose.yml`. Если его не изменять, Streamlit будет доступен по ссылке localhost:18501.

# Развернутый на удаленном сервере сервис

С помощью github-actions развернут (и автоматически деплоится при создании тега) сервис на удаленном сервере в yandex-cloud. Увидеть его работу можно тут: http://84.201.145.245:18501.